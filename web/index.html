<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Postulaciones Staff ‚Äî MineDash</title>
<link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@400;700;900&family=Rajdhani:wght@300;400;600;700&display=swap" rel="stylesheet">
<style>
  :root {
    --red: #e63946;
    --red-dark: #9b1c1c;
    --red-glow: rgba(230, 57, 70, 0.4);
    --bg: #0a0a0a;
    --bg2: #111111;
    --bg3: #181818;
    --border: rgba(230, 57, 70, 0.2);
    --text: #f0f0f0;
    --muted: #888;
  }
  * { margin: 0; padding: 0; box-sizing: border-box; }
  body {
    background: var(--bg);
    color: var(--text);
    font-family: 'Rajdhani', sans-serif;
    min-height: 100vh;
    overflow-x: hidden;
  }
  body::before {
    content: '';
    position: fixed;
    inset: 0;
    background-image:
      linear-gradient(rgba(230,57,70,0.03) 1px, transparent 1px),
      linear-gradient(90deg, rgba(230,57,70,0.03) 1px, transparent 1px);
    background-size: 40px 40px;
    pointer-events: none;
    z-index: 0;
  }
  body::after {
    content: '';
    position: fixed;
    top: -20%;
    left: 50%;
    transform: translateX(-50%);
    width: 600px;
    height: 600px;
    background: radial-gradient(circle, rgba(230,57,70,0.12) 0%, transparent 70%);
    pointer-events: none;
    z-index: 0;
  }
  nav {
    position: sticky; top: 0; z-index: 100;
    background: rgba(10,10,10,0.9);
    backdrop-filter: blur(12px);
    border-bottom: 1px solid var(--border);
    padding: 0 2rem; height: 60px;
    display: flex; align-items: center; justify-content: space-between;
  }
  .nav-logo { font-family: 'Orbitron', monospace; font-weight: 900; font-size: 1.1rem; color: var(--red); letter-spacing: 2px; }
  .nav-logo span { color: var(--text); }
  .nav-breadcrumb { font-size: 0.85rem; color: var(--muted); letter-spacing: 1px; }
  .nav-breadcrumb a { color: var(--red); text-decoration: none; }
  .nav-user {
    display: flex;
    align-items: center;
    gap: 0.6rem;
    background: rgba(255,255,255,0.04);
    border: 1px solid var(--border);
    border-radius: 40px;
    padding: 4px 12px 4px 4px;
    opacity: 0;
    transform: translateX(10px);
    transition: opacity 0.3s ease, transform 0.3s ease;
  }
  .nav-user.loaded { opacity: 1; transform: translateX(0); }
  .nav-avatar {
    width: 32px; height: 32px; border-radius: 50%;
    border: 2px solid var(--red); object-fit: cover;
    flex-shrink: 0; background: var(--bg3);
  }
  .nav-username {
    font-size: 0.82rem; font-weight: 600; color: var(--text);
    letter-spacing: 0.5px; max-width: 120px;
    white-space: nowrap; overflow: hidden; text-overflow: ellipsis;
  }
  .nav-divider { width: 1px; height: 16px; background: var(--border); flex-shrink: 0; }
  .btn-logout {
    display: inline-flex; align-items: center; gap: 4px;
    background: none; border: none; color: var(--muted);
    font-family: 'Orbitron', monospace; font-size: 0.6rem;
    font-weight: 700; letter-spacing: 1.5px; text-transform: uppercase;
    cursor: pointer; padding: 2px 0; transition: color 0.2s; text-decoration: none;
  }
  .btn-logout:hover { color: var(--red); }
  .btn-logout svg { width: 12px; height: 12px; flex-shrink: 0; }
  .nav-skeleton {
    width: 130px; height: 40px; border-radius: 40px;
    background: linear-gradient(90deg, var(--bg3) 25%, #222 50%, var(--bg3) 75%);
    background-size: 200% 100%;
    animation: shimmer 1.2s infinite;
  }
  @keyframes shimmer {
    0% { background-position: 200% 0; }
    100% { background-position: -200% 0; }
  }
  main { position: relative; z-index: 1; max-width: 820px; margin: 0 auto; padding: 3rem 1.5rem 5rem; }
  .hero { text-align: center; margin-bottom: 3rem; animation: fadeDown 0.6s ease both; }
  @keyframes fadeDown { from { opacity: 0; transform: translateY(-20px); } to { opacity: 1; transform: translateY(0); } }
  @keyframes fadeUp { from { opacity: 0; transform: translateY(20px); } to { opacity: 1; transform: translateY(0); } }
  .hero-badge {
    display: inline-block;
    background: rgba(230,57,70,0.15); border: 1px solid var(--red); color: var(--red);
    font-family: 'Orbitron', monospace; font-size: 0.65rem; letter-spacing: 3px;
    padding: 4px 14px; border-radius: 2px; margin-bottom: 1.2rem; text-transform: uppercase;
  }
  .hero h1 { font-family: 'Orbitron', monospace; font-size: clamp(1.8rem, 5vw, 3rem); font-weight: 900; line-height: 1.1; margin-bottom: 1rem; }
  .hero h1 span { color: var(--red); }
  .hero-sub { color: var(--muted); font-size: 1.05rem; font-weight: 300; max-width: 560px; margin: 0 auto; line-height: 1.6; }
  .info-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 1rem; margin-bottom: 2.5rem; animation: fadeUp 0.6s 0.1s ease both; }
  .info-card { background: var(--bg2); border: 1px solid var(--border); border-radius: 6px; padding: 1.4rem; position: relative; overflow: hidden; }
  .info-card::before { content: ''; position: absolute; top: 0; left: 0; width: 3px; height: 100%; background: var(--red); }
  .info-card h3 { font-family: 'Orbitron', monospace; font-size: 0.7rem; letter-spacing: 2px; color: var(--red); text-transform: uppercase; margin-bottom: 0.8rem; }
  .info-card ul { list-style: none; color: #ccc; font-size: 0.95rem; line-height: 1.8; font-weight: 300; }
  .info-card ul li::before { content: '‚ñ∏ '; color: var(--red); }
  .divider { display: flex; align-items: center; gap: 1rem; margin: 2.5rem 0; animation: fadeUp 0.6s 0.15s ease both; }
  .divider::before, .divider::after { content: ''; flex: 1; height: 1px; background: var(--border); }
  .divider span { font-family: 'Orbitron', monospace; font-size: 0.65rem; letter-spacing: 3px; color: var(--red); text-transform: uppercase; white-space: nowrap; }
  .form-card { background: var(--bg2); border: 1px solid var(--border); border-radius: 8px; padding: 2.5rem; animation: fadeUp 0.6s 0.2s ease both; position: relative; overflow: hidden; }
  .form-card::before { content: ''; position: absolute; top: 0; left: 0; right: 0; height: 2px; background: linear-gradient(90deg, transparent, var(--red), transparent); }
  .form-header { margin-bottom: 2rem; }
  .form-header h2 { font-family: 'Orbitron', monospace; font-size: 1rem; font-weight: 700; letter-spacing: 2px; margin-bottom: 0.4rem; }
  .form-header p { color: var(--muted); font-size: 0.9rem; font-weight: 300; }
  .field-group { margin-bottom: 1.6rem; }
  label { display: block; font-size: 0.82rem; font-weight: 700; letter-spacing: 1.5px; text-transform: uppercase; color: #ccc; margin-bottom: 0.5rem; }
  label .num { display: inline-flex; align-items: center; justify-content: center; width: 20px; height: 20px; background: var(--red); color: #fff; font-size: 0.65rem; border-radius: 3px; margin-right: 0.5rem; font-family: 'Orbitron', monospace; }
  input[type="text"], textarea, select {
    width: 100%; background: var(--bg3); border: 1px solid rgba(230,57,70,0.25);
    border-radius: 5px; padding: 0.8rem 1rem; color: var(--text);
    font-family: 'Rajdhani', sans-serif; font-size: 1rem; font-weight: 400;
    transition: border-color 0.2s, box-shadow 0.2s; outline: none; resize: vertical;
  }
  input:focus, textarea:focus, select:focus { border-color: var(--red); box-shadow: 0 0 0 3px var(--red-glow); }
  textarea { min-height: 90px; }
  .row-2 { display: grid; grid-template-columns: 1fr 1fr; gap: 1rem; }
  .form-footer { margin-top: 2.5rem; display: flex; align-items: center; justify-content: space-between; gap: 1rem; flex-wrap: wrap; }
  .form-note { font-size: 0.82rem; color: var(--muted); font-weight: 300; }
  .btn-submit {
    font-family: 'Orbitron', monospace; font-size: 0.75rem; font-weight: 700;
    letter-spacing: 2px; text-transform: uppercase; color: #fff; background: var(--red);
    border: none; padding: 0.9rem 2.2rem; border-radius: 5px; cursor: pointer;
    position: relative; overflow: hidden; transition: transform 0.15s, box-shadow 0.2s;
  }
  .btn-submit:hover { transform: translateY(-1px); box-shadow: 0 6px 24px var(--red-glow); }
  .btn-submit:active { transform: translateY(0); }
  .btn-submit.loading { pointer-events: none; opacity: 0.7; }
  .toast {
    position: fixed; bottom: 2rem; right: 2rem; z-index: 999;
    background: var(--bg2); border: 1px solid var(--border); border-radius: 8px;
    padding: 1rem 1.5rem; display: flex; align-items: center; gap: 0.8rem;
    transform: translateY(100px); opacity: 0; transition: all 0.35s ease;
    max-width: 340px; box-shadow: 0 10px 40px rgba(0,0,0,0.5);
  }
  .toast.show { transform: translateY(0); opacity: 1; }
  .toast-icon { font-size: 1.4rem; flex-shrink: 0; }
  .toast-title { font-family: 'Orbitron', monospace; font-size: 0.75rem; letter-spacing: 1px; margin-bottom: 2px; }
  .toast-msg { font-size: 0.85rem; color: var(--muted); font-weight: 300; }
  .toast.success { border-color: rgba(52,199,89,0.4); }
  .toast.success .toast-title { color: #34c759; }
  .toast.error { border-color: rgba(230,57,70,0.5); }
  .toast.error .toast-title { color: var(--red); }
  @media (max-width: 640px) {
    .info-grid, .row-2 { grid-template-columns: 1fr; }
    .form-footer { flex-direction: column; align-items: stretch; }
    .btn-submit { text-align: center; }
    .form-card { padding: 1.5rem; }
    .nav-username { max-width: 80px; }
  }
</style>
</head>
<body>

<nav>
  <div class="nav-logo">Mine<span>Dash</span></div>
  <div class="nav-breadcrumb"><a href="#">Inicio</a> / Postulaciones Staff</div>

  <div id="nav-user-skeleton" class="nav-skeleton"></div>
  <div class="nav-user" id="nav-user-widget">
    <img class="nav-avatar" id="nav-avatar" src="" alt="avatar">
    <span class="nav-username" id="nav-username"></span>
    <div class="nav-divider"></div>
    <a href="/logout" class="btn-logout" title="Cerrar sesi√≥n">
      <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round">
        <path d="M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4"/>
        <polyline points="16 17 21 12 16 7"/>
        <line x1="21" y1="12" x2="9" y2="12"/>
      </svg>
      Salir
    </a>
  </div>
</nav>

<main>
  <div class="hero">
    <div class="hero-badge">‚ö° Reclutamiento Activo</div>
    <h1>Postulaciones para<br><span>Staff MineDash</span></h1>
    <p class="hero-sub">¬øTienes lo que se necesita? Completa el formulario con honestidad y detalle. Cada respuesta cuenta.</p>
  </div>

  <div class="info-grid">
    <div class="info-card">
      <h3>üìã Requisitos</h3>
      <ul>
        <li>M√≠nimo 14 a√±os de edad</li>
        <li>Cuenta premium</li>
        <li>Historial limpio en el servidor</li>
        <li>No ser staff en otro servidor</li>
        <li>Buena ortograf√≠a y madurez</li>
      </ul>
    </div>
    <div class="info-card">
      <h3>‚ö†Ô∏è Importante</h3>
      <ul>
        <li>Responde con seriedad y honestidad</li>
        <li>Informaci√≥n falsa = descalificaci√≥n</li>
        <li>Revisi√≥n en varios d√≠as</li>
        <li>Resultado enviado por Discord</li>
        <li>Una sola postulaci√≥n por usuario</li>
      </ul>
    </div>
  </div>

  <div class="divider"><span>Formulario de Postulaci√≥n</span></div>

  <div class="form-card">
    <div class="form-header">
      <h2>Completa todos los campos</h2>
      <p>Cada respuesta es le√≠da cuidadosamente por el equipo. S√© claro y detallado.</p>
    </div>

    <form id="postulacion-form">
      <div class="field-group">
        <label><span class="num">1</span> ¬øNombre y Edad? <small style="color:var(--muted)">Por favor pon tu nombre completo y tu edad.</small></label>
        <textarea name="p1" placeholder="Answer here.." required></textarea>
      </div>
      <div class="field-group">
        <label><span class="num">2</span> ¬øCu√°l es tu usuario de Discord y tu id? <small style="color:var(--muted)">Aqu√≠ tienes que poner tu nombre o id de discord.</small></label>
        <textarea name="p2" placeholder="Answer here.." required></textarea>
      </div>
      <div class="field-group">
        <label><span class="num">3</span> ¬øEres Premium?</label>
        <select name="p3" required>
          <option value="" disabled selected>Selecciona...</option>
          <option value="S√≠">‚úÖ S√≠</option>
          <option value="No">‚ùå No</option>
        </select>
      </div>
      <div class="field-group">
        <label><span class="num">4</span> ¬øEres jugador de Java o Bedrock?</label>
        <select name="p4" required>
          <option value="" disabled selected>Selecciona...</option>
          <option value="Java">‚òï Java</option>
          <option value="Bedrock">üì± Bedrock</option>
          <option value="Ambos">‚ö° Ambos</option>
        </select>
      </div>
      <div class="field-group">
        <label><span class="num">5</span> ¬øDe qu√© pa√≠s eres?</label>
        <textarea name="p5" placeholder="Answer here.." required></textarea>
      </div>
      <div class="field-group">
        <label><span class="num">6</span> ¬øCu√°nto tiempo le podr√≠as dedicar al servidor de MineDash?</label>
        <textarea name="p6" placeholder="Answer here.." required></textarea>
      </div>
      <div class="field-group">
        <label><span class="num">7</span> ¬øTienes experiencia siendo staff en otro servidor? <small style="color:var(--muted)">Si es as√≠, ind√≠canos el rango, servidor y motivo por el que ya no formas parte del mismo.</small></label>
        <textarea name="p7" placeholder="Answer here.." required></textarea>
      </div>
      <div class="field-group">
        <label><span class="num">8</span> ¬øPor qu√© quieres formar parte del Staff Team?</label>
        <textarea name="p8" placeholder="Answer here.." required></textarea>
      </div>
      <div class="field-group">
        <label><span class="num">9</span> ¬øHace cuanto tiempo juegas MineDash | Network?</label>
        <textarea name="p9" placeholder="Answer here.." required></textarea>
      </div>
      <div class="field-group">
        <label><span class="num">10</span> ¬øMenci√≥name al menos 3 comandos b√°sicos qu√© usa un staff? <small style="color:var(--muted)">(no cuenta /ban /tp /kick /mute /warn)</small></label>
        <textarea name="p10" placeholder="Answer here.." required></textarea>
      </div>
      <div class="field-group">
        <label><span class="num">11</span> ¬øHace cuanto tiempo juegas minecraft?</label>
        <textarea name="p11" placeholder="Answer here.." required></textarea>
      </div>
      <div class="field-group">
        <label><span class="num">12</span> Califica tu, Ortograf√≠a & Madurez. <small style="color:var(--muted)">del 1 al 10 calif√≠cate</small></label>
        <textarea name="p12" placeholder="Answer here.." required></textarea>
      </div>
      <div class="field-group">
        <label><span class="num">13</span> ¬øCu√°les ser√≠an tus aspiraciones en el Staff Team?</label>
        <textarea name="p13" placeholder="Answer here.." required></textarea>
      </div>
      <div class="field-group">
        <label><span class="num">14</span> ¬øPor que crees que deber√≠amos elegirte a ti y no a otro postulante?</label>
        <textarea name="p14" placeholder="Answer here.." required></textarea>
      </div>
      <div class="field-group">
        <label><span class="num">15</span> ¬øSabes que es Spam? <small style="color:var(--muted)">Si es as√≠, explica que significa este t√©rmino.</small></label>
        <textarea name="p15" placeholder="Answer here.." required></textarea>
      </div>
      <div class="field-group">
        <label><span class="num">16</span> ¬øQu√© har√≠as si encuentras un Hacker en el servidor, pero no tienes el rango para sancionarlo?</label>
        <textarea name="p16" placeholder="Answer here.." required></textarea>
      </div>
      <div class="field-group">
        <label><span class="num">17</span> ¬øSabes que es Flood? <small style="color:var(--muted)">Si es as√≠, ind√≠canos que significa este t√©rmino.</small></label>
        <textarea name="p17" placeholder="Answer here.." required></textarea>
      </div>
      <div class="field-group">
        <label><span class="num">18</span> Supongamos que un Staff empieza a abusar de sus permisos. <small style="color:var(--muted)">¬øQu√© har√≠as en esa situaci√≥n?</small></label>
        <textarea name="p18" placeholder="Answer here.." required></textarea>
      </div>
      <div class="field-group">
        <label><span class="num">19</span> ¬øQu√© har√≠as en caso de que un usuario abra un ticket para reportar un bug?</label>
        <textarea name="p19" placeholder="Answer here.." required></textarea>
      </div>
      <div class="field-group">
        <label><span class="num">20</span> ¬øQu√© es una ScreenShare?</label>
        <textarea name="p20" placeholder="Answer here.." required></textarea>
      </div>
      <div class="field-group">
        <label><span class="num">21</span> Menciona los programas que utilizar√≠as en una SS y como los usar√≠as.</label>
        <textarea name="p21" placeholder="Answer here.." required></textarea>
      </div>
      <div class="field-group">
        <label><span class="num">22</span> Menciona el nombre de al menos 3 Ghost Client.</label>
        <textarea name="p22" placeholder="Answer here.." required></textarea>
      </div>
      <div class="field-group">
        <label><span class="num">23</span> ¬øCu√°l es la diferencia entre una Macro y un AutoClick?</label>
        <textarea name="p23" placeholder="Answer here.." required></textarea>
      </div>
      <div class="form-footer">
        <p class="form-note">Al enviar confirmas que toda la informaci√≥n es ver√≠dica.</p>
        <button type="submit" class="btn-submit" id="submit-btn">Enviar Postulaci√≥n ‚Üí</button>
      </div>
    </form>
  </div>
</main>

<div class="toast" id="toast">
  <div class="toast-icon" id="toast-icon">‚úÖ</div>
  <div>
    <div class="toast-title" id="toast-title">Postulaci√≥n enviada</div>
    <div class="toast-msg" id="toast-msg">Tu postulaci√≥n lleg√≥ correctamente.</div>
  </div>
</div>

<script>
  (async () => {
    const skeleton = document.getElementById('nav-user-skeleton');
    const widget   = document.getElementById('nav-user-widget');
    const avatar   = document.getElementById('nav-avatar');
    const username = document.getElementById('nav-username');

    try {
      const res  = await fetch('/me');
      const data = await res.json();

      if (data.ok && data.user) {
        const u = data.user;
        if (u.avatar) {
          avatar.src = `https://cdn.discordapp.com/avatars/${u.id}/${u.avatar}.png?size=64`;
        } else {
          const defaultIndex = Number(BigInt(u.id) >> 22n) % 6;
          avatar.src = `https://cdn.discordapp.com/embed/avatars/${defaultIndex}.png`;
        }
        avatar.onerror = () => { avatar.src = `https://cdn.discordapp.com/embed/avatars/0.png`; };
        username.textContent = u.global_name || u.username;
        skeleton.style.display = 'none';
        widget.classList.add('loaded');
      } else {
        window.location.href = '/';
      }
    } catch (e) {
      skeleton.style.display = 'none';
    }
  })();

  (async () => {
    try {
      const res  = await fetch('/ya_postulo');
      const json = await res.json();
      if (json.enviado) mostrarPantallaYaEnviada();
    } catch (e) {}
  })();

  function mostrarPantallaYaEnviada() {
    const mainEl = document.querySelector('main');
    mainEl.innerHTML = `
      <div style="text-align:center; padding: 4rem 1.5rem; animation: fadeDown 0.6s ease both;">
        <div style="
          display:inline-flex; align-items:center; justify-content:center;
          width:90px; height:90px; border-radius:50%;
          background: rgba(230,57,70,0.1); border: 2px solid var(--red);
          font-size:2.5rem; margin-bottom:1.5rem;
          box-shadow: 0 0 30px rgba(230,57,70,0.4);
        ">üì¨</div>
        <div style="
          display:inline-block; background:rgba(230,57,70,0.15);
          border:1px solid var(--red); color:var(--red);
          font-family:'Orbitron',monospace; font-size:0.6rem; letter-spacing:3px;
          padding:4px 14px; border-radius:2px; margin-bottom:1.2rem; text-transform:uppercase; display:block;
        ">Postulacion Registrada</div>
        <h2 style="font-family:'Orbitron',monospace; font-size:clamp(1.4rem,4vw,2.2rem); font-weight:900; margin-bottom:1rem; line-height:1.2;">
          Tu postulacion ya fue<br><span style="color:var(--red);">enviada correctamente</span>
        </h2>
        <p style="color:#888; font-size:1rem; font-weight:300; max-width:480px; margin:0 auto 2rem; line-height:1.7;">
          Hemos recibido tu formulario y esta siendo revisado por el equipo.<br>
          Recibiras una notificacion por Discord cuando haya una decision.
        </p>
        <div style="
          background:#111; border:1px solid rgba(230,57,70,0.2); border-radius:10px;
          padding:1.5rem 2rem; max-width:420px; margin:0 auto;
          display:flex; align-items:center; gap:1rem; text-align:left;
          position:relative; overflow:hidden;
        ">
          <div style="position:absolute;top:0;left:0;right:0;height:2px;background:linear-gradient(90deg,transparent,#e63946,transparent);"></div>
          <div style="font-size:2rem; flex-shrink:0;">‚è≥</div>
          <div>
            <div style="font-family:'Orbitron',monospace; font-size:0.7rem; letter-spacing:2px; color:#e63946; text-transform:uppercase; margin-bottom:4px;">Estado actual</div>
            <div style="font-size:1rem; font-weight:600; color:#eee;">Pendiente de revision</div>
            <div style="font-size:0.82rem; color:#888; font-weight:300; margin-top:2px;">La revision puede tardar varios dias.</div>
          </div>
        </div>
        <p style="margin-top:2rem; font-size:0.8rem; color:#888;">
          Crees que hay un error? Contacta a un administrador en Discord.
        </p>
      </div>`;
  }

  const form  = document.getElementById("postulacion-form");
  const btn   = document.getElementById("submit-btn");
  const toast = document.getElementById("toast");

  function showToast(type, title, msg) {
    toast.className = "toast " + type;
    document.getElementById("toast-icon").textContent  = type === "success" ? "‚úÖ" : "‚ùå";
    document.getElementById("toast-title").textContent = title;
    document.getElementById("toast-msg").textContent   = msg;
    toast.classList.add("show");
    setTimeout(() => toast.classList.remove("show"), 5000);
  }

  form && form.addEventListener("submit", async (e) => {
    e.preventDefault();
    const data = Object.fromEntries(new FormData(form));

    btn.classList.add("loading");
    btn.textContent = "Enviando...";

    try {
      const res  = await fetch("/enviar", {
        method: "POST",
        headers: { "Content-Type": "application/json" },
        body: JSON.stringify(data)
      });
      const json = await res.json();

      if (json.ok) {
        mostrarPantallaYaEnviada();
        window.scrollTo({ top: 0, behavior: "smooth" });
      } else if (json.error === "ya_postulo") {
        mostrarPantallaYaEnviada();
      } else {
        throw new Error(json.error || "Error desconocido");
      }
    } catch (err) {
      showToast("error", "Error al enviar", "No se pudo enviar. Asegurate de que el bot esta activo.");
      btn.classList.remove("loading");
      btn.textContent = "Enviar Postulacion";
    }
  });
</script>
</body>
</html>
